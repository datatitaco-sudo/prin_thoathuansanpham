<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£n Th·ªèa Thu·∫≠n S·∫£n Ph·∫©m - TITACO</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #003366;
            --text-color: #000;
        }

        * { box-sizing: border-box; font-family: "Times New Roman", Times, serif; }
        body { background-color: #f0f0f0; margin: 0; padding: 0; }

        /* Khung trang A4 t·ªëi ∆∞u ƒë·ªÉ kh√¥ng r·ªõt trang */
        .page {
            width: 210mm;
            height: 297mm; /* C·ªë ƒë·ªãnh chi·ªÅu cao A4 */
            padding: 8mm 15mm; /* Gi·∫£m padding ƒë·ªÉ tƒÉng di·ªán t√≠ch ch·ª©a n·ªôi dung */
            margin: 5mm auto;
            background: white;
            position: relative;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            overflow: hidden; /* NgƒÉn ch·∫∑n vi·ªác tr√†n n·ªôi dung */
        }

        #watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 130px;
            color: rgba(150, 150, 150, 0.1);
            font-weight: bold;
            z-index: 0;
            pointer-events: none;
            display: none;
        }

        /* Header g·ªçn g√†ng */
        .header-table { width: 100%; border-collapse: collapse; border-bottom: 2px solid #ffcc00; margin-bottom: 8px; }
        .logo-img { width: 120px; height: auto; display: block; object-fit: contain; }
        .company-info { text-align: left; padding-left: 10px; vertical-align: middle; }
        .company-info h2 { 
            margin: 0; 
            color: var(--primary-color); 
            font-size: 15px; 
            text-transform: uppercase; 
            white-space: nowrap; 
            letter-spacing: -0.2px; 
        }
        .company-info p { margin: 1px 0; font-size: 11px; color: #333; }

        .doc-no { text-align: left; font-size: 13px; margin: 5px 0; }
        .doc-title { text-align: center; margin-bottom: 10px; }
        .doc-title h1 { margin: 0; font-size: 20px; text-transform: uppercase; }
        .doc-title p { margin: 2px 0; font-style: italic; font-weight: bold; font-size: 14px; }

        .section-title { font-weight: bold; text-transform: uppercase; margin-top: 8px; text-decoration: underline; font-size: 14px; display: block; }
        .info-block { margin-bottom: 8px; line-height: 1.3; font-size: 14px; }
        .info-row { display: flex; margin-bottom: 2px; }
        .label { font-weight: bold; min-width: 110px; }

        /* B·∫£ng h√†ng h√≥a g·ªçn l·∫°i */
        table.data-table { width: 100%; border-collapse: collapse; margin: 8px 0; }
        table.data-table th, table.data-table td { border: 1px solid #000; padding: 6px; font-size: 13px; }
        table.data-table th { background-color: #f2f2f2; text-align: center; }
        .text-right { text-align: right; }
        .text-center { text-align: center; }

        /* V√πng chi·∫øt kh·∫•u - quan tr·ªçng nh·∫•t ƒë·ªÉ kh√¥ng r·ªõt trang */
        .note-box { 
            border: 1px dashed #ccc; 
            padding: 8px; 
            background: #fafafa; 
            font-style: italic; 
            white-space: pre-wrap; 
            font-size: 13px; 
            margin: 5px 0;
            line-height: 1.2;
        }

        /* Ch·ªØ k√Ω thu h·∫πp chi·ªÅu cao */
        .footer-sign { display: flex; justify-content: space-between; margin-top: 15px; text-align: center; }
        .sign-box { width: 45%; font-size: 14px; }
        .sign-space { height: 60px; } /* Gi·∫£m t·ª´ 100px xu·ªëng 60px ƒë·ªÉ k√©o n·ªôi dung l√™n */

        /* ƒêi·ªÅu khi·ªÉn n√∫t b·∫•m */
        .controls { position: fixed; top: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 1000; }
        button { padding: 12px 20px; cursor: pointer; border: none; border-radius: 5px; color: white; font-weight: bold; font-size: 14px; transition: 0.3s; }
        .btn-print { background: #007bff; }
        .btn-png { background: #28a745; }
        button:hover { opacity: 0.8; }

        @media print {
            body { background: none; }
            .page { margin: 0; box-shadow: none; border: none; width: 100%; height: 100%; }
            .controls { display: none; }
            @page { size: A4; margin: 0; }
        }
    </style>
</head>
<body>

    <div class="controls">
        <button class="btn-print" onclick="window.print()">In Phi·∫øu</button>
        <button class="btn-png" onclick="downloadPNG()">T·∫£i ·∫£nh PNG</button>
    </div>

    <div class="page" id="capture">
        <div id="watermark">DEMO</div>

        <!-- Header -->
        <table class="header-table">
            <tr>
                <td width="140">
                    <img src="./LOGOTINTAM%202.png" class="logo-img" alt="Logo">
                </td>
                <td class="company-info">
                    <h2>C√îNG TY TNHH ƒê·∫¶U T∆Ø V√Ä PH√ÅT TRI·ªÇN TH∆Ø∆†NG M·∫†I T√çN T√ÇM</h2>
                    <p>üìç 65 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng Long Xuy√™n, T·ªânh An Giang</p>
                    <p>üìû 02963 95 99 77 | ‚úâÔ∏è info.tita.gmail.com | üåê www.titatrading.com</p>
                </td>
            </tr>
        </table>

        <div class="doc-no">S·ªë: <span id="Sott">......</span></div>

        <div class="doc-title">
            <h1>B·∫¢N TH·ªéA THU·∫¨N</h1>
            <p>(V/v: <span id="LoaiThoaThuan">Th·ªèa thu·∫≠n s·∫£n ph·∫©m</span>)</p>
        </div>

        <div class="info-block">
            <p>CƒÉn c·ª© nhu c·∫ßu v√† kh·∫£ nƒÉng h·ª£p t√°c c·ªßa hai b√™n.</p>
            <p>H√¥m nay ng√†y <span id="NgayKy">../../....</span>, t·∫°i vƒÉn ph√≤ng T√≠n T√¢m ch√∫ng t√¥i g·ªìm c√≥:</p>
            
            <p><strong>B√äN A: C√îNG TY TNHH ƒê·∫¶U T∆Ø V√Ä PH√ÅT TRI·ªÇN TH∆Ø∆†NG M·∫†I T√çN T√ÇM</strong></p>
            <p>ƒê·∫°i di·ªán: <strong>√îng HU·ª≤NH THANH NHU·∫¨N</strong> - Ch·ª©c v·ª•: Gi√°m ƒë·ªëc</p>

            <p><strong>B√äN B: <span id="TenKH">...</span></strong></p>
            <div class="info-row"><span class="label">ƒê·ªãa ch·ªâ:</span> <span id="DiaChi">...</span></div>
            <div class="info-row"><span class="label">ƒêi·ªán tho·∫°i:</span> <span id="DienThoai">...</span></div>
            <div class="info-row">
                <span class="label">MST:</span> <span id="MST">...</span>
                <span style="margin-left: 20px;"><strong>CCCD:</strong> <span id="CCCD">...</span></span>
            </div>
            <div class="info-row"><span class="label">ƒê·∫°i di·ªán:</span> <span id="DaiDien">...</span></div>
        </div>

        <span class="section-title">ƒêI·ªÄU 1: H√ÄNG H√ìA, QUY C√ÅCH & GI√Å B√ÅN</span>
        <table class="data-table">
            <thead>
                <tr>
                    <th width="40">Stt</th>
                    <th>N·ªôi dung th·ªèa thu·∫≠n / S·∫£n ph·∫©m</th>
                    <th>Th·ªùi h·∫°n</th>
                    <th width="120">Th√†nh Ti·ªÅn</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="text-center">1</td>
                    <td id="DsThoaThuan">...</td>
                    <td class="text-center"><span id="TuNgay">...</span> - <span id="DenNgay">...</span></td>
                    <td class="text-right"><strong id="TongTien">0</strong></td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="3" class="text-right"><strong>T·ªîNG C·ªòNG:</strong></td>
                    <td class="text-right"><strong id="TongTienTotal">0</strong> VNƒê</td>
                </tr>
            </tfoot>
        </table>

        <span class="section-title">ƒêI·ªÄU 2: CHI·∫æT KH·∫§U & GHI CH√ö</span>
        <div class="note-box" id="ChietKhau">...</div>
        <p style="font-size: 13px; margin: 5px 0;"><strong>Ghi ch√∫/Tr·∫°ng th√°i:</strong> <span id="GhiChu">...</span> | <span id="TrangThai">...</span></p>

        <div class="footer-sign">
            <div class="sign-box">
                <strong>ƒê·∫†I DI·ªÜN B√äN A</strong><br>Gi√°m ƒë·ªëc
                <div class="sign-space"></div>
                <strong style="color: #003366;">HU·ª≤NH THANH NHU·∫¨N</strong>
            </div>
            <div class="sign-box">
                <strong>ƒê·∫†I DI·ªÜN B√äN B</strong><br>Ch·ªß c·ª≠a h√†ng
                <div class="sign-space"></div>
                <strong id="DaiDienKyTen">...</strong>
            </div>
        </div>

        <div style="position: absolute; bottom: 5mm; left: 15mm; font-size: 9px; color: #999;">
            Xu·∫•t l√∫c: <span id="time-stamp"></span> | TITACO Management System
        </div>
    </div>

    <script>
        const demoData = {
            Sott: "001_25.HƒêMB.TITA",
            LoaiThoaThuan: "Th·ªèa thu·∫≠n s·∫£n ph·∫©m",
            NgayKy: "02/02/2025",
            TenKH: "Ch·ªã Nga",
            DaiDien: "YORNG NGA",
            MST: "1602034463",
            CCCD: "0890XXXXXXXX",
            DiaChi: "X√£ Kh√°nh An, Huy·ªán An Ph√∫, T·ªânh An Giang",
            DienThoai: "0388188747",
            DsThoaThuan: "50 th√πng C·∫∑p ·∫•n ƒë·ªô 240ml & 20 th√πng Samurai SOTO 500ml",
            TongTien: "222,000,000",
            TuNgay: "10/02/2025",
            DenNgay: "20/02/2025",
            ChietKhau: "- B√™n B nh·∫≠n m·ªôt l·∫ßn v√† thanh to√°n ƒë·ªß 50 th√πng C·∫∑p ·∫•n ƒë·ªô 240ml b√™n A s·∫Ω t·∫∑ng th√™m 200 USD cho b√™n B.\n- B√™n B nh·∫≠n m·ªôt l·∫ßn v√† thanh to√°n ƒë·ªß 20 th√πng Samurai SOTO 500ml b√™n A s·∫Ω t·∫∑ng th√™m 01 th√πng Samurai SOTO 500ml cho b√™n B.",
            GhiChu: "Thanh to√°n ngay",
            TrangThai: "ƒêang th·ª±c hi·ªán"
        };

        function init() {
            const urlParams = new URLSearchParams(window.location.search);
            let hasData = false;

            Object.keys(demoData).forEach(key => {
                const val = urlParams.get(key);
                const element = document.getElementById(key);
                if (element) {
                    if (val) {
                        element.innerText = val;
                        hasData = true;
                        if(key === 'TongTien') document.getElementById('TongTienTotal').innerText = val;
                        if(key === 'DaiDien') document.getElementById('DaiDienKyTen').innerText = val;
                    } else {
                        element.innerText = demoData[key];
                    }
                }
            });

            if (!hasData) document.getElementById('watermark').style.display = 'block';
            document.getElementById('time-stamp').innerText = new Date().toLocaleString();
        }

        function downloadPNG() {
            const btn = document.querySelector('.btn-png');
            btn.innerText = "ƒêang x·ª≠ l√Ω...";
            html2canvas(document.getElementById('capture'), { scale: 2, useCORS: true }).then(canvas => {
                const link = document.createElement('a');
                link.download = `ThoaThuan_TITACO.png`;
                link.href = canvas.toDataURL();
                link.click();
                btn.innerText = "T·∫£i ·∫£nh PNG";
            });
        }

        window.onload = init;
    </script>
</body>
</html>
