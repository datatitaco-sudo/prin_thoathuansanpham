<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£n Th·ªèa Thu·∫≠n S·∫£n Ph·∫©m - TITACO</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #003366;
            --text-color: #000;
        }

        * { box-sizing: border-box; font-family: "Times New Roman", Times, serif; }
        body { background-color: #f0f0f0; margin: 0; padding: 0; }

        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 10mm 15mm;
            margin: 10mm auto;
            background: white;
            position: relative;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }

        #watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 150px;
            color: rgba(150, 150, 150, 0.15);
            font-weight: bold;
            z-index: 10;
            pointer-events: none;
            display: none;
        }

        /* T·ªëi ∆∞u Header ƒë·ªÉ kh√¥ng xu·ªëng d√≤ng */
        .header-table { width: 100%; border-collapse: collapse; border-bottom: 2px solid #ffcc00; margin-bottom: 10px; }
        
        .logo-img { 
            width: 130px; /* Gi·∫£m nh·∫π c·ª° logo */
            height: auto; 
            display: block;
            object-fit: contain;
        }

        .company-info { text-align: left; padding-left: 10px; vertical-align: middle; }
        
        /* C·∫•u h√¨nh ƒë·∫∑c bi·ªát cho t√™n c√¥ng ty */
        .company-info h2 { 
            margin: 0; 
            color: var(--primary-color); 
            font-size: 15px; /* Gi·∫£m size ch·ªØ */
            text-transform: uppercase; 
            white-space: nowrap; /* √âp kh√¥ng xu·ªëng d√≤ng */
            letter-spacing: -0.3px; /* Thu h·∫πp kho·∫£ng c√°ch ch·ªØ */
        }
        
        .company-info p { margin: 2px 0; font-size: 12px; color: #333; }

        .doc-no { text-align: left; font-size: 14px; margin: 10px 0; }
        .doc-title { text-align: center; margin-bottom: 20px; }
        .doc-title h1 { margin: 0; font-size: 22px; text-transform: uppercase; }
        .doc-title p { margin: 5px 0; font-style: italic; font-weight: bold; }

        .section-title { font-weight: bold; text-transform: uppercase; margin-top: 15px; text-decoration: underline; }
        .info-block { margin-bottom: 15px; line-height: 1.5; font-size: 15px; }
        .info-row { display: flex; margin-bottom: 3px; }
        .label { font-weight: bold; min-width: 120px; }

        table.data-table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        table.data-table th, table.data-table td { border: 1px solid #000; padding: 8px; font-size: 14px; }
        table.data-table th { background-color: #eee; text-align: center; }
        .text-right { text-align: right; }
        .text-center { text-align: center; }

        .footer-sign { display: flex; justify-content: space-between; margin-top: 40px; text-align: center; }
        .sign-box { width: 45%; }
        .sign-space { height: 100px; }

        .controls { position: fixed; top: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 1000; }
        button { padding: 10px 15px; cursor: pointer; border: none; border-radius: 4px; color: white; font-weight: bold; }
        .btn-print { background: #007bff; }
        .btn-png { background: #28a745; }

        @media print {
            body { background: none; }
            .page { margin: 0; box-shadow: none; border: none; width: 100%; }
            .controls { display: none; }
            @page { size: A4; margin: 0; }
        }
    </style>
</head>
<body>

    <div class="controls">
        <button class="btn-print" onclick="window.print()">In Phi·∫øu (PDF)</button>
        <button class="btn-png" onclick="downloadPNG()">T·∫£i ·∫£nh PNG</button>
    </div>

    <div class="page" id="capture">
        <div id="watermark">DEMO</div>

        <!-- Header -->
        <table class="header-table">
            <tr>
                <td width="140">
                    <img src="./LOGOTINTAM%202.png" class="logo-img" alt="Logo">
                </td>
                <td class="company-info">
                    <h2>C√îNG TY TNHH ƒê·∫¶U T∆Ø V√Ä PH√ÅT TRI·ªÇN TH∆Ø∆†NG M·∫†I T√çN T√ÇM</h2>
                    <p>üìç 65 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng Long Xuy√™n, T·ªânh An Giang</p>
                    <p>üìû 02963 95 99 77 | ‚úâÔ∏è info.tita.gmail.com | üåê www.titatrading.com</p>
                </td>
            </tr>
        </table>

        <div class="doc-no">S·ªë: <span id="Sott">......</span></div>

        <div class="doc-title">
            <h1>B·∫¢N TH·ªéA THU·∫¨N</h1>
            <p>(V/v: <span id="LoaiThoaThuan">Th·ªèa thu·∫≠n s·∫£n ph·∫©m</span>)</p>
        </div>

        <div class="info-block">
            <p>CƒÉn c·ª© nhu c·∫ßu v√† kh·∫£ nƒÉng h·ª£p t√°c c·ªßa hai b√™n.</p>
            <p>H√¥m nay ng√†y <span id="NgayKy">../../....</span>, t·∫°i VƒÉn ph√≤ng C√¥ng ty TNHH ƒê·∫ßu t∆∞ v√† Ph√°t tri·ªÉn Th∆∞∆°ng m·∫°i T√≠n T√¢m ch√∫ng t√¥i g·ªìm c√≥:</p>
            
            <p><strong>B√äN A: C√îNG TY TNHH ƒê·∫¶U T∆Ø V√Ä PH√ÅT TRI·ªÇN TH∆Ø∆†NG M·∫†I T√çN T√ÇM</strong></p>
            <p>ƒê·ªãa ch·ªâ: 65 ƒêi·ªán Bi√™n Ph·ªß, Ph∆∞·ªùng Long Xuy√™n, T·ªânh An Giang</p>
            <p>- ƒêi·ªán tho·∫°i: 02963 95 99 77 - MST: 1602034463</p>
            <p>- ƒê·∫°i di·ªán: √îng HU·ª≤NH THANH NHU·∫¨N - Ch·ª©c v·ª•: Gi√°m ƒê·ªëc</p>

            <p><strong>B√äN B: <span id="TenKH">...</span></strong></p>
            <div class="info-row"><span class="label">ƒê·ªãa ch·ªâ:</span> <span id="DiaChi">...</span></div>
            <div class="info-row"><span class="label">ƒêi·ªán tho·∫°i:</span> <span id="DienThoai">...</span></div>
            <div class="info-row">
                <span class="label">MST:</span> <span id="MST">...</span>
                <span class="label" style="margin-left: 20px;">CCCD:</span> <span id="CCCD">...</span>
            </div>
            <div class="info-row"><span class="label">ƒê·∫°i di·ªán:</span> <span id="DaiDien">...</span></div>
        </div>

        <div class="section-title">ƒêI·ªÄU 1: H√ÄNG H√ìA, QUY C√ÅCH & GI√Å B√ÅN</div>
        <table class="data-table">
            <thead>
                <tr>
                    <th width="50">Stt</th>
                    <th>T√™n S·∫£n Ph·∫©m / N·ªôi Dung</th>
                    <th>ƒêVT</th>
                    <th>S·ªë l∆∞·ª£ng</th>
                    <th>Th√†nh Ti·ªÅn</th>
                </tr>
            </thead>
            <tbody id="DsThoaThuanTable">
                <tr>
                    <td class="text-center">1</td>
                    <td id="DsThoaThuan">...</td>
                    <td class="text-center">G√≥i</td>
                    <td class="text-center">1</td>
                    <td class="text-right"><strong id="TongTien">0</strong></td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="4" class="text-right"><strong>T·ªîNG C·ªòNG:</strong></td>
                    <td class="text-right"><strong id="TongTienTotal">0</strong> VNƒê</td>
                </tr>
            </tfoot>
        </table>

        <div class="section-title">ƒêI·ªÄU 2: TH·ªúI GIAN TH·ª∞C HI·ªÜN</div>
        <div class="info-block">
            Th·ªùi gian ƒë·ªÉ b√™n B th·ª±c hi·ªán t·ª´ ng√†y <span id="TuNgay">...</span> ƒë·∫øn ng√†y <span id="DenNgay">...</span>
        </div>

        <div class="section-title">ƒêI·ªÄU 3: CHI·∫æT KH·∫§U & GHI CH√ö</div>
        <div class="info-block" id="ChietKhau" style="white-space: pre-wrap; font-style: italic;">
            ...
        </div>
        <p><strong>Ghi ch√∫:</strong> <span id="GhiChu">...</span></p>

        <div class="footer-sign" style="margin-top: 20px;">
            <div class="sign-box">
                <strong>ƒê·∫†I DI·ªÜN B√äN A</strong><br>Gi√°m ƒë·ªëc
                <div class="sign-space"></div>
                <strong>HU·ª≤NH THANH NHU·∫¨N</strong>
            </div>
            <div class="sign-box">
                <strong>ƒê·∫†I DI·ªÜN B√äN B</strong><br>Ch·ªß c·ª≠a h√†ng
                <div class="sign-space"></div>
                <strong id="DaiDienKyTen">...</strong>
            </div>
        </div>
    </div>

    <script>
        const demoData = {
            Sott: "001_25.HƒêMB.TITA",
            LoaiThoaThuan: "Th·ªèa thu·∫≠n s·∫£n ph·∫©m",
            NgayKy: "02/02/2025",
            TenKH: "Ch·ªã Nga",
            DaiDien: "YORNG NGA",
            MST: "16020xxxx",
            CCCD: "0890xxxxxxx",
            DiaChi: "X√£ Kh√°nh An, Huy·ªán An Ph√∫, T·ªânh An Giang",
            DienThoai: "0388188747",
            DsThoaThuan: "C·∫∑p ·∫§n ƒê·ªô 240ml & Samurai SOTO 500ml",
            TongTien: "222,000,000",
            TuNgay: "10/02/2025",
            DenNgay: "20/02/2025",
            ChietKhau: "- B√™n B nh·∫≠n m·ªôt l·∫ßn v√† thanh to√°n ƒë·ªß 50 th√πng C·∫∑p ·∫•n ƒë·ªô 240ml b√™n A s·∫Ω t·∫∑ng th√™m 200 USD cho b√™n B.\n- B√™n B nh·∫≠n m·ªôt l·∫ßn v√† thanh to√°n ƒë·ªß 20 th√πng Samurai SOTO 500ml b√™n A s·∫Ω t·∫∑ng th√™m 01 th√πng Samurai SOTO 500ml cho b√™n B.",
            GhiChu: "ƒêang th·ª±c hi·ªán"
        };

        function init() {
            const urlParams = new URLSearchParams(window.location.search);
            let hasData = false;

            Object.keys(demoData).forEach(key => {
                const val = urlParams.get(key);
                const element = document.getElementById(key);
                if (element) {
                    if (val) {
                        element.innerText = val;
                        hasData = true;
                        if(key === 'TongTien') document.getElementById('TongTienTotal').innerText = val;
                        if(key === 'DaiDien') document.getElementById('DaiDienKyTen').innerText = val;
                    } else {
                        element.innerText = demoData[key];
                    }
                }
            });

            if (!hasData) {
                document.getElementById('watermark').style.display = 'block';
            }
        }

        function downloadPNG() {
            html2canvas(document.getElementById('capture'), { 
                scale: 2,
                useCORS: true 
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `ThoaThuan_${document.getElementById('Sott').innerText}.png`;
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        window.onload = init;
    </script>
</body>
</html>
